# üîß MemoryLink Environment Configuration
# Copy this file to .env and customize for your environment

# =============================================================================
# üöÄ BASIC CONFIGURATION
# =============================================================================

# OpenAI API Configuration (REQUIRED)
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=text-embedding-ada-002
OPENAI_MAX_RETRIES=3
OPENAI_TIMEOUT=30

# =============================================================================
# üóÑÔ∏è DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Database Settings
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=memorylink
POSTGRES_USER=memorylink
POSTGRES_PASSWORD=your-secure-password-here

# Database Connection Pool
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# Database Performance Tuning
DB_MAX_CONNECTIONS=100
DB_SHARED_BUFFERS=256MB
DB_EFFECTIVE_CACHE_SIZE=1GB
DB_WORK_MEM=4MB
DB_MAINTENANCE_WORK_MEM=64MB

# =============================================================================
# üåê API SERVER CONFIGURATION
# =============================================================================

# Server Settings
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4

# CORS Configuration
CORS_ORIGINS=["http://localhost:3000", "http://localhost:8080", "https://yourdomain.com"]
CORS_ALLOW_CREDENTIALS=false
CORS_ALLOW_METHODS=["GET", "POST", "PUT", "DELETE", "OPTIONS"]
CORS_ALLOW_HEADERS=["*"]

# Request Limits
MAX_CONTENT_LENGTH=102400  # 100KB per memory
MAX_QUERY_LENGTH=1000      # Max search query length
REQUEST_TIMEOUT=30         # Request timeout in seconds

# =============================================================================
# üîí SECURITY CONFIGURATION
# =============================================================================

# API Authentication (Production)
API_KEY_REQUIRED=false
API_KEYS=api-key-1,api-key-2,api-key-3

# Rate Limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000
RATE_LIMIT_PER_DAY=10000

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CONTENT_SECURITY_POLICY="default-src 'self'"

# =============================================================================
# üìä LOGGING CONFIGURATION  
# =============================================================================

# Log Settings
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json # json, text
LOG_ROTATION=daily
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=7

# Log Destinations
LOG_TO_FILE=true
LOG_TO_CONSOLE=true
LOG_FILE_PATH=./logs/memorylink.log

# =============================================================================
# ‚ö° PERFORMANCE CONFIGURATION
# =============================================================================

# Embedding Processing
EMBEDDING_BATCH_SIZE=10
EMBEDDING_CACHE_SIZE=1000
EMBEDDING_TIMEOUT=30

# Search Configuration
SEARCH_TIMEOUT=30
SEARCH_MAX_RESULTS=100
SEARCH_DEFAULT_THRESHOLD=0.3

# Caching (Redis)
REDIS_ENABLED=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=memorylink_redis_pass
REDIS_DB=0
REDIS_MAX_MEMORY=256mb
REDIS_CACHE_TTL=3600  # 1 hour

# =============================================================================
# üê≥ DOCKER CONFIGURATION
# =============================================================================

# Docker Compose Settings
COMPOSE_PROJECT_NAME=memorylink

# Port Mappings
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443
POSTGRES_EXTERNAL_PORT=127.0.0.1:5432
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000

# Data Paths
DATA_PATH=./data
LOG_PATH=./logs
BACKUP_PATH=./backups

# Build Configuration
BUILD_DATE=now
VCS_REF=unknown

# =============================================================================
# üìà MONITORING CONFIGURATION
# =============================================================================

# Prometheus Metrics
PROMETHEUS_ENABLED=false
PROMETHEUS_PATH=/metrics

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30

# Application Metrics
METRICS_COLLECTION_ENABLED=true
METRICS_RETENTION_DAYS=30

# =============================================================================
# üîî NOTIFICATIONS (Optional)
# =============================================================================

# Email Notifications
EMAIL_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
ADMIN_EMAIL=admin@yourcompany.com

# Slack Notifications
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# =============================================================================
# üåç ENVIRONMENT SPECIFIC
# =============================================================================

# Environment Type
ENVIRONMENT=development  # development, staging, production

# Debug Settings
DEBUG=false
DEBUG_SQL=false
DEBUG_API_CALLS=false

# Feature Flags
FEATURE_ADVANCED_SEARCH=true
FEATURE_BULK_IMPORT=true
FEATURE_EXPORT=true
FEATURE_ANALYTICS=true

# =============================================================================
# üöÄ PRODUCTION SPECIFIC
# =============================================================================

# SSL/TLS Configuration (Production)
SSL_ENABLED=false
SSL_CERT_PATH=/path/to/ssl/cert.pem
SSL_KEY_PATH=/path/to/ssl/key.pem
SSL_CA_PATH=/path/to/ssl/ca.pem

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_ENABLED=false
BACKUP_S3_BUCKET=memorylink-backups
BACKUP_S3_REGION=us-west-2

# =============================================================================
# üß™ DEVELOPMENT SPECIFIC  
# =============================================================================

# Development Tools
DEV_AUTO_RELOAD=true
DEV_CORS_ALL_ORIGINS=true
DEV_DETAILED_ERRORS=true

# Test Configuration
TEST_DATABASE_URL=postgresql://test_user:test_pass@localhost:5433/test_memorylink
TEST_OPENAI_API_KEY=test-key-for-mocking

# =============================================================================
# üìù CUSTOM CONFIGURATION
# =============================================================================

# Custom Memory Types
CUSTOM_MEMORY_TYPES=note,bookmark,task,code,meeting,idea

# Custom Metadata Fields
CUSTOM_METADATA_FIELDS=priority,project,category,difficulty,source

# Integration Settings
WEBHOOK_ENABLED=false
WEBHOOK_URL=https://your-app.com/memorylink-webhook
WEBHOOK_SECRET=your-webhook-secret

# =============================================================================
# üí° CONFIGURATION TIPS
# =============================================================================

# 1. Never commit this file with real secrets to version control
# 2. Use strong, unique passwords for production
# 3. Enable API key authentication in production
# 4. Configure appropriate CORS origins for your frontend
# 5. Set up SSL/TLS certificates for production deployments
# 6. Monitor your OpenAI API usage and costs
# 7. Regular database backups are essential
# 8. Use environment-specific configuration files
# 9. Consider using container secrets for sensitive data
# 10. Monitor resource usage and scale accordingly

# =============================================================================
# üÜò TROUBLESHOOTING
# =============================================================================

# Common Issues:
# - OPENAI_API_KEY not set: Get key from https://platform.openai.com
# - Database connection failed: Check POSTGRES_* settings
# - Port already in use: Change API_PORT or stop conflicting service
# - Permission denied: Check file/directory permissions
# - Out of memory: Increase container memory limits

# Debug Steps:
# 1. Check logs: docker-compose logs memorylink
# 2. Verify environment: docker-compose exec memorylink env
# 3. Test database: docker-compose exec db pg_isready
# 4. Check API health: curl http://localhost:8000/health
# 5. Validate OpenAI key: curl -H "Authorization: Bearer $OPENAI_API_KEY" https://api.openai.com/v1/models